generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
  moduleFormat    = "cjs"
}

datasource db {
  provider = "postgresql"
}

model Users {
  id                String            @id @default(uuid())
  username          String            @unique
  password          String
  role              String

  createdAt         DateTime          @default(now()) @map("created_at")
  updatedAt         DateTime          @updatedAt @map("updated_at")

  @@map("users")
}

model Organizations {
  id                String            @id @default(uuid())
  name              String   
  address           String
  parkingSessions   ParkingSessions[]
  
  createdAt         DateTime          @default(now()) @map("created_at")
  updatedAt         DateTime          @updatedAt @map("updated_at")

  @@map("organizations")
}

model ParkingSessions {
  id                 String            @id @default(uuid())  
  vehicleType        VehicleType       @map("vehicle_type")
  vehicleModel       String?           @map("vehicle_model")
  plateNumber        String            @map("plate_number")
  enteredAt          DateTime          @map("entered_at")
  exitedAt           DateTime?         @map("exited_at")
  parkingCredits     Float?            @map("parking_credits")
  durationMinutes    Int?              @map("duration_minutes")
  parkingFee         Float?            @map("parking_fee")
  parkingState       ParkingState      @map("parking_state") @default(ACTIVE)
  paymentStatus      PaymentStatus     @map("payment_status") @default(UNPAID)
  guardRemarks       String?           @map("guard_remarks")
  // discountType       DiscountType      @map("discount_type") @default(NONE)
  // discountIdNumber   String?           @map("discount_id_number")
  // discountAmount     Float?            @map("discount_amount")

  organizationId     String            @map("organization_id")
  organization       Organizations     @relation(fields: [organizationId], references: [id])

  createdAt          DateTime          @default(now())
  updatedAt          DateTime          @updatedAt

  @@map("parking_sessions")
}

enum VehicleType {
  VEHICLE
  MOTORCYCLE
}

enum ParkingState {
  ACTIVE
  EXITED
}

enum PaymentStatus {
  UNPAID
  PAID
  OVERDUE
}

enum DiscountType {
  NONE
  PWD
  SENIOR
}